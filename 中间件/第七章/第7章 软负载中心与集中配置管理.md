
----------
12/27/2016 1:00:28 PM 

----------

# 软负载中心与集中配置管理 #

1. 软件负载中心最基础的职责
 	- 聚合地址信息
 	- 生命周期感知
2. 软负载中心的结构
	- 软负载中心的服务端
	- 软负载中心的客户端
	- 软负载中心重要数据
		- 聚合数据
		- 订阅关系
		- 连接数据
3. 内容聚合功能的设计
	- 保证数据的正确性
	- 高效聚合数据
		- 并发下的数据正确性保证
			- ConcurrentHashMap
				- putIfAbsent()
		- 数据更新、删除的顺序保证
		- 大量数据同时插入、更新时的性能保证
4. 解决服务上下线的感知
	- 通过客户端与服务端的连接感知
		- 心跳
			- 软负载中心的客户端上增加逻辑，验证连接是否可用
	- 通过对于发布数据中提供的地址端口进行连接的检查
		- 另一个独立的监控应用连接验证之前发布的地址、端口号
			- 软负载中心的客户端上增加逻辑，验证连接是否可用

5. 软负载中心的数据分发的特点和设计
	- 数据分发与消息订阅的区别
		- 消息中间件需要保证消息不丢失，软件负载中心只需要保证最新的数据推送到相关的订阅者
		- 消息中间件中，同一个集群中的不同机器分享所有消息，这个消息只需要一台机器处理即可；软负载中心需要把数据分发给集群中所有机器
	- 提升数据分发性能
		- 数据压缩
		- 全量与增量的选择
6. 针对服务化的特性支持
	- 软负载数据分组 
		- 根据环境进行区分
		- 分优先级的隔离
	- 提供自动感知意外的上下线开关
		- 优雅的停止使用
		- 保持应用场景，用于排错
	- 维护管理路由规则
7. 从单机到集群
	- 数据管理的问题
	- 连接管理的问题
	- 数据统一管理方案
	- 数据对等管理方案
8. 集中配置中心
	- 提供给应用使用的客户端
	- 为控制台或者控制脚本提供管理SDK
	- 客户端实现和容灾策略
		- 数据缓存
		- 数据快照
		- 本地配置
		- 文件格式
	- 服务端实现和容灾策略
		- 通过当前服务端更新数据库
		- 定时检查服务端的数据与数据库中数据的一致性

9. 数据库策略
	- 支持配置的版本管理
		- 方便进行配置变更的对比及回滚
		- 数据库本身需要主备数据的容灾考虑