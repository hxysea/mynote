----------
1/9/2017 7:06:39 PM 

----------
# Kafka #
1. 创建背景
	- 高性能跨语言分布式发布/订阅消息队列系统
	- 源于LinkedIn，用作LinkedIn的**活动流(Activity Stream)** 和**系统处理数据管道（Pipeline）** 的基础
		- 活动流数据
			- 用户操作产生的数据
				- 页面访问量
				- 被查看内容方面的信息
				- 搜索情况
				- 应用场景
					- 时间线
						- 新鲜事提醒
						- 用户浏览量排名
		- 系统处理数据
			- 服务器性能数据
				- CPU
				- IO使用率
				- 请求时间
				- 服务日志
				- 应用场景
					- 后台服务
						- 监控恶意攻击服务器用户
						- 监控服务器性能
						- 出现问题及时报警
	- 设计依据
		- 硬盘线性读写的情况下性能优异
		- 减少JVM的GC触发
			- JVM对象扎用实际数据外较多空间，结构不紧凑，浪费空间
2. 简介
	- 时间复杂度为O(1)的持久化能力
		- 消息数据磁盘**线性存储**
	- 高吞吐率
	- 消费者状态自己维护
		- 去除服务端维护消费状态压力
		- 提升了消费者存储消费状态的自由度
			- zookeeper
			- hdfs
		- 消息消费失败，消费者可以回滚而重新消费消息
	- Kafka Server支持消息分区及分布式消费，保证每个partition内的消息顺序传输
	- 同时支持离线和实时数据处理
	- 支持水平扩展  
3. 优点
	- 解耦
		- 生产者与消费者解耦，降低了系统复杂性
	- 冗余
	- 扩展性
	- 灵活性&峰值处理能力
	- 可恢复性  
	- 顺序保证
	- 缓冲
	- 异步通信
4. 与常用Message Queue对比
	-  Rabbit MQ
		- 非常重量级，更适合于企业级的开发
	- Redis
		- 可以当做一个轻量级的队列服务来使用
		- 小数据量时入队性能优于Rabbit MQ
		- 出队性能优异
	- Zero MQ
		- 独特非中间件模式
		- 非持久化队列
	- Active MQ
		- 少量代码可以高效实现高级应用场景
		- 与RabbitMQ、ZeroMQ类似
	- Kafka/Jafka
		- Kafka的升级版
		- 完全的分布式系统，自动实现负载均衡
		- 支持Hadoop数据并行加载
		- 轻量级的消息系统，性能非常好
5. e.g.
	- "动态汇总"功能
	- 相关性以及排序
	- 安全
	- 运营监控
	- 报表和批处理  
6. 组成
	- ZooKeeper
	- Kafka
		- Producer
		- Broker
		- Consumer  
			- consumer group
7. 实现
	- 一个Topic对应多个Consumer Group
		- 实现广播，每个consumer有一个独立的group
		- 实现单播，所有consumer在同一个group  
8. 示例
	- 更新索引
		- 用户更新数据
		- producer产生数据到broker
		- consumer即时获取该数据，进而更新索引
