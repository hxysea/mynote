### Dubbo RPC通信原理及源码分析

- 核心类
  - InvokerInvocationHandler
    - RpcInvocation
    - Method
    - Invoker
      - MockClusterInvoker
      - FailOverClusterInvoker
      - DubboInvoker

- RPC封装本质——Java代理

  - RPC本质为**消息处理模型**，RPC**屏蔽**了**底层**不同主机间的**通信细节**，让进程调用远程的服务就像是本地的服务一样
  - 通信模型
    - NIO——分而治之
  - 服务定位
    - 使用给定通信方式/协议，与给定的IP和Port及方法名称确定具体的过程或方法
    - 远程代理对象
      - 字节码增强
      - **动态代理**

        - **反射**
          - Method
          - args
          - result


  - 协议编码/解码
    - 确定请求消息结构
      - 接口方法
        - 接口名称
        - 方法名
      - 方法参数
        - 参数类型及参数值
      - 调用属性
        - 超时时间
        - requestId
    - 确定响应消息结构
      - 返回结果
        - 接口方法中定义的返回值
      - 返回码
        - 异常返回码
      - 返回异常信息
        - 调用异常信息
        - requestId
  - 序列化和反序列化
    - 序列化：数据结构/对象-->字节
    - 反序列化：字节-->数据结构/对象
    - 序列化选择标准
      - 通用性
        - 支持Map等复杂数据结构
      - 性能
        - 时间复杂度和空间复杂度
      - 可扩展性
        - 支持自动增加新的业务字段
        - 删除老字段，不影响老的业务

- RPC架构

  - 服务提供者
    - 运行在服务端，提供服务接口定义与服务实现类


  - 服务中心
    - 运行在服务端，负责将本地服务发不成远程服务，管理远程服务，提供给服务消费者使用


  - 服务消费者
    - 运行在客户端，通过远程代理对象调用远程服务





